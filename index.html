<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>基本情報合格ToDo & 壁紙コレクション</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Yuji+Syuku&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <div class="left-sidebar">
        <div class="streak-box stats-box">
            <h4>過去問平均 (％)</h4>
            <div class="stat-row">
                <span>今週:</span>
                <span id="weeklyAverage" class="stat-value">--</span>
                <span class="unit">%</span>
            </div>
            
            <div class="history-area">
                <div id="weeklyHistory" class="history-list"></div>
            </div>
            <div class="stat-row small-stat">
                <span>先週比:</span>
                <span id="weeklyDiff" class="stat-diff">--</span>
            </div>
            <button class="record-btn" id="openScoreModalBtn">✏️ 記録</button>
        </div>

        <div class="streak-box">
            <h4>連続達成</h4>
            <div class="streak-count-area"><span id="streak-count">0</span> 日</div>
        </div>
        <div class="omikuji-container">
            <button id="omikujiBtn" class="omikuji-btn">🥠 今日の運勢</button>
        </div>
    </div>

    <div class="status-container">
        <div class="inventory-box item-display">
            <h4 id="toggleInventoryBtn">所持素材 <span class="toggle-icon">▼</span></h4>
            <div class="inventory-content" id="inventoryContent">
                <div class="item-row"><span><img src="画像/ペンキ.png" alt="ペンキ" class="item-icon">ペンキ:</span> <span id="count-belt">0</span></div>
                <div class="item-row"><span><img src="画像/筆.png" alt="筆" class="item-icon">筆:</span> <span id="count-body">0</span></div>
                <div class="item-row"><span><img src="画像/布.png" alt="布" class="item-icon">布:</span> <span id="count-bezel">0</span></div>
                <div class="item-row"><span><img src="画像/キャンバス.png" alt="キャンバス" class="item-icon">キャンバス:</span> <span id="count-chip">0</span></div>
                <div class="item-row"><span><img src="画像/設計図.png" alt="設計図" class="item-icon">設計図:</span> <span id="count-light">0</span></div>
            </div>
        </div>
    </div>

    <div class="header">
        <h2>基本情報技術者試験 ToDo</h2>
        
        <div class="countdown-container">
            <div id="countdownDisplay" class="countdown-display is-hidden">
                試験まであと <span id="countdownDays" class="countdown-number">0</span> 日！
            </div>
            <button id="setExamDateBtn" class="exam-setting-btn">📅 試験日設定</button>
        </div>

        <div class="display-toggle">
            <button id="toggleListBtn" class="active-toggle" data-target="list">リスト</button>
            <button id="toggleCalendarBtn" data-target="calendar">カレンダー</button>
            <button id="toggleWallpaperBtn" data-target="wallpaper">壁紙ギャラリー</button>
        </div>

        <div class="score-box">
            獲得ポイント: <span id="score">0</span> pt
        </div>
    </div>

    <div class="input-container">
        <div class="input-group">
            <select id="taskType">
                <option value="daily">デイリー (10pt)</option>
                <option value="weekly">ウィークリー (20pt)</option>
                <option value="normal">通常 (10pt)</option>
            </select>
            <input type="text" id="taskInput" placeholder="タスクを入力...（例: 過去問10問解く）">
            <button id="addBtn">追加</button>
        </div>
    </div>

    <div class="shop-section">
        <h3>画材店 (素材ショップ)</h3>
        <p class="shop-desc">ポイント(100pt)で素材を購入し、壁紙をアンロックしよう！</p>
        <div class="shop-buttons" id="shopButtons">
            <button data-item="belt">ペンキ</button>
            <button data-item="body">筆</button>
            <button data-item="bezel">布</button>
            <button data-item="chip">キャンバス</button>
            <button data-item="light">設計図</button>
        </div>
    </div>

    <div id="listView">
        <div class="section section-daily">
            <h3>デイリータスク <span id="timer-daily" class="limit-timer"></span></h3>
            <ul id="dailyList" class="task-list"></ul>
            <div class="done-header is-open">
                <h4 class="done-title">達成済み</h4>
                <div class="done-controls">
                    <button class="bulk-delete-btn" data-type="daily">一括削除</button>
                    <button class="toggle-list-btn" data-target="dailyListCleared">▼ 隠す</button>
                </div>
            </div>
            <ul id="dailyListCleared" class="task-list cleared-list"></ul>
        </div>

        <div class="section section-weekly">
            <h3>ウィークリータスク <span id="timer-weekly" class="limit-timer"></span></h3>
            <ul id="weeklyList" class="task-list"></ul>
            <div class="done-header is-open">
                <h4 class="done-title">達成済み</h4>
                <div class="done-controls">
                    <button class="bulk-delete-btn" data-type="weekly">一括削除</button>
                    <button class="toggle-list-btn" data-target="weeklyListCleared">▼ 隠す</button>
                </div>
            </div>
            <ul id="weeklyListCleared" class="task-list cleared-list"></ul>
        </div>

        <div class="section section-normal">
            <h3>通常タスク</h3>
            <ul id="normalList" class="task-list"></ul>
            <div class="done-header is-open">
                <h4 class="done-title">達成済み</h4>
                <div class="done-controls">
                    <button class="bulk-delete-btn" data-type="normal">一括削除</button>
                    <button class="toggle-list-btn" data-target="normalListCleared">▼ 隠す</button>
                </div>
            </div>
            <ul id="normalListCleared" class="task-list cleared-list"></ul>
        </div>
    </div>

    <div id="calendarView" class="is-hidden">
        <div class="calendar-controls">
            <button id="prevMonthBtn">前の月</button>
            <h3 id="currentMonth"></h3>
            <button id="nextMonthBtn">次の月</button>
        </div>
        <table class="calendar-table">
            <thead><tr><th>日</th><th>月</th><th>火</th><th>水</th><th>木</th><th>金</th><th>土</th></tr></thead>
            <tbody id="calendarTableBody"></tbody>
        </table>
        <div id="selectedDateInfo" class="selected-date-info is-hidden">
            <h4 id="selectedDateTitle"></h4>
            
            <div class="memo-section">
                <div class="memo-input-area">
                    <textarea id="memoInput" placeholder="メモを入力..."></textarea>
                    <div class="tag-input-row">
                        <input type="text" id="tagNameInput" placeholder="タグ名" maxlength="6">
                        <input type="color" id="tagColorInput" value="#ff6347">
                        <button class="save-memo-btn" id="addMemoBtn">＋追加</button>
                    </div>
                    <div id="savedTagsList" class="saved-tags-list"></div>
                </div>
                <div class="memo-list-container" id="dailyMemoList"></div>
            </div>

            <div class="history-section">
                <h5>完了履歴</h5>
                <ul id="selectedDateTaskList"></ul>
            </div>
        </div>
    </div>

    <div id="wallpaperView" class="is-hidden">
        <div class="section wallpaper-section">
            <h3>壁紙ギャラリー</h3>
            <p class="shop-desc">
                アンロックには <strong>全種類の素材が1つずつ</strong> 必要です。<br>
                クリックして背景に設定できます。
            </p>
            <div id="wallpaperGrid" class="wallpaper-grid"></div>
        </div>
    </div>

    <div id="toastContainer" class="toast-container"></div>
    
    <div id="actionModal" class="modal-overlay is-hidden">
        <div class="modal-content">
            <h4 id="modalTitle" class="modal-title">確認</h4>
            <div id="modalBody" class="modal-body-content"><p id="modalMessage" class="modal-message"></p></div>
            <div class="modal-buttons">
                <button id="modalConfirmBtn" class="modal-btn delete">実行する</button>
                <button class="modal-btn cancel" id="modalCancelBtn">キャンセル</button>
            </div>
        </div>
    </div>
    
    <div id="examModal" class="modal-overlay is-hidden">
        <div class="modal-content">
            <h4 class="modal-title">試験日設定</h4>
            <p class="exam-modal-desc">目標日を設定してください。</p>
            <input type="date" id="examDateInput">
            <div class="modal-buttons">
                <button class="modal-btn save-exam" id="saveExamDateBtn">保存</button>
                <button class="modal-btn cancel" id="closeExamModalBtn">閉じる</button>
            </div>
        </div>
    </div>

    <div id="scoreModal" class="modal-overlay is-hidden">
        <div class="modal-content">
            <h4 class="modal-title">過去問点数記録</h4>
            <p class="exam-modal-desc">正答率(%)を入力してください</p>
            <div class="input-group" style="margin-bottom:15px;">
                <input type="number" id="scoreInput" placeholder="例: 65" min="0" max="100">
                <span style="align-self:center; font-weight:bold;">%</span>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn save-exam" id="saveScoreBtn">記録する</button>
                <button class="modal-btn cancel" id="closeScoreModalBtn">閉じる</button>
            </div>
        </div>
    </div>

    <script type="module" src="js/main.js"></script>
</body>
</html>